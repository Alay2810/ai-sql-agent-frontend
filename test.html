<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connection Test</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    .test { margin: 20px 0; padding: 15px; background: white; border-radius: 8px; }
    .success { border-left: 4px solid #4CAF50; }
    .error { border-left: 4px solid #f44336; }
    button { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; }
    pre { background: #f5f5f5; padding: 10px; border-radius: 5px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>Backend Connection Test</h1>
  
  <button onclick="testHealth()">Test Health Endpoint</button>
  <div id="healthResult" class="test"></div>

  <button onclick="testUpload()">Test Upload Endpoint</button>
  <div id="uploadResult" class="test"></div>

  <script>
    async function testHealth() {
      const div = document.getElementById('healthResult');
      div.innerHTML = 'Testing...';
      
      try {
        const response = await fetch('http://localhost:5000/health');
        const data = await response.json();
        div.className = 'test success';
        div.innerHTML = `<h3>✓ Success!</h3><pre>${JSON.stringify(data, null, 2)}</pre>`;
      } catch (err) {
        div.className = 'test error';
        div.innerHTML = `<h3>✗ Failed</h3><p>${err.message}</p>`;
      }
    }

    async function testUpload() {
      const div = document.getElementById('uploadResult');
      div.innerHTML = 'Testing...';
      
      try {
        const formData = new FormData();
        formData.append('tableName', 'test');
        // No file - will get error but tests connection
        
        const response = await fetch('http://localhost:5000/upload', {
          method: 'POST',
          body: formData
        });
        
        const data = await response.json();
        
        if (data.error && data.error === 'CSV file required') {
          div.className = 'test success';
          div.innerHTML = `<h3>✓ Endpoint accessible!</h3><p>Error is expected (no file sent)</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
        } else {
          div.className = 'test success';
          div.innerHTML = `<h3>✓ Response received</h3><pre>${JSON.stringify(data, null, 2)}</pre>`;
        }
      } catch (err) {
        div.className = 'test error';
        div.innerHTML = `<h3>✗ Failed</h3><p>${err.message}</p><p>Make sure backend is running on http://localhost:5000</p>`;
      }
    }
  </script>
</body>
</html>